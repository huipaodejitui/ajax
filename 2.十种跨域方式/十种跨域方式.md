# 十种实现跨域的方式

## 1.降级浏览器

### 并非真的实现了跨域，只是把浏览器的拦截给撤掉了

## 2.cors

### 1.前端向服务器发送请求

```
xhr.open("post", "http://localhost:3000")
xhr.setRequestHeader("name", "znc")
xhr.send('name="zbc"&age=26')
```

[完整代码](./2.cors/index.html)

### 2.后端处理前端的请求

```
res.setHeader("Access-Control-Allow-Origin", "http://localhost:4000");
res.setHeader("Access-Control-Allow-Headers", "name");
```

[完整代码](./2.cors/server.js)

## 3.nginx

* 服务器之间不跨越，代理服务器

## 4.http- proxy

* 服务器 3000 端口：http://localhost:3000 数据 ok

* http- proxy 代理 4000 端口：http://localhost:4000 数据 ok

### 1.启动后端

```

```

### 2.启动 proxy-middleware

####

```
const proxy = proxyMiddleWare("/", {
  target: "http://localhost:3000",
  changeOrigin: true
});
app.use("/*", proxy);
```

### 3.前端访问http://localhost:3000/index.html

```

```

## 5.jsonp

* 利用 script、img 标签允许跨域的特征

### 前端代码

```
//定义回调函数
function show(data) {
    console.log(data)
}
//定义jsonp
function jsonp(url) {

    var head = document.querySelector('head')
    var script = document.createElement('script')
    script.src = "http://localhost:3000?" + url
    head.appendChild(script)
}
//发送请求得到数据
var url = "name=zbc&age=26&jsonp=show"
jsonp(url, function (data) {
    console.log(data)
})
```

[完整代码](./5.jsonp/index.html)

### 后端代码

```
server.on("request", function(req, res) {
  var params = url.parse(req.url, true).query;
  var fn = params.jsonp;
  res.writeHead(200, { "Content-Type": "text/javascript" });
  res.write(fn + "(" + JSON.stringify(params) + ")");
  res.end();
});
```

[完整代码](./5.jsonp/server.js)

## 6.domain

* 二级域名之间跨域，子域名指定其一级域名

* frame.contentWindow 中有传过来的值

## 7.name

* a、b 页面同源

* a、c 页面跨域

* a：a 页面有 c 页面,a 中替换 c 页面为 b 页面

* c:传值

* a：iframe.contentWindow 中有传过来的值

## 8.hash

* a、b 页面同源

* a、c 页面跨域

* a：a 页面有 c 页面

* c:创建 b 页面并传值

* b:window.parent.parent.location.hash = location.hash

* a:得到 c 中的 b 传过来的值

## 9.postMessage

* 相当于代理服务器

* a:frame.contentWindow.postMessage 传数据；window.onmessage 接数据

* b:window.onmessage 接数据；e.source.postMessage 传数据

## 10.websocket

* a：a 页面http://localhost:4000/a.html

* websocket 服务器 3000 端口两者之间可以通信
